(self.webpackChunktiny_files=self.webpackChunktiny_files||[]).push([[846],{1846:(i,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>l});var e=function(){var i=this,t=i.$createElement,n=i._self._c||t;return n("div",{staticClass:"content",attrs:{id:"tiny-login"}},[n("h1",[i._v("login")]),i._v(" "),n("div",{staticClass:"form"},[n("b-field",[n("b-input",{attrs:{placeholder:"username@tinyhome.site",pattern:"\\w+@.+","icon-right":"account",disabled:i.working},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&i._k(t.keyCode,"enter",13,t.key,"Enter")?null:i.login()}},model:{value:i.origin,callback:function(t){i.origin=t},expression:"origin"}})],1)],1),i._v(" "),n("div",{attrs:{id:"buttons"}},[n("a",{class:{disabled:!i.origin||i.working,"has-text-grey-lighter":i.origin&&!i.working,"hover-warning":i.origin&&!i.working},on:{click:function(t){return i.login(!1)}}},[i._v("login (root)")]),i._v(" "),n("div",{staticStyle:{"flex-grow":"1"}}),i._v(" "),n("b-button",{attrs:{type:"is-primary",disabled:!i.origin||i.working,loading:i.working},on:{click:function(t){return i.login()}}},[i._v("login")])],1)])};e._withStripped=!0;var r=n(9461),o=n(7853);const s=n(7670).Z.component("tiny-login",{data:()=>({working:!1,origin:""}),watch:{registering(i,t){!i!=!t&&(this.origin="")}},async mounted(){if(this.$route.query.code&&r.Z.homeUrl){this.working=!0;await o.Z.auth.getTokens(r.Z.homeUrl,""+this.$route.query.code).then((()=>!0),(i=>!1))?(r.Z.storeUser=await o.Z.auth.getStoreUser(),this.$router.push("/browse")):(r.Z.clear(),this.$router.replace("/login")),this.working=!1}},methods:{async login(i){if(this.working||!this.origin||!/\w+@.+/.test(this.origin))return;this.working=!0;await o.Z.auth.login(this.origin,i).then((()=>!0),(i=>!1))&&(!this.$route.query.goto||this.$route.query.goto instanceof Array?this.$router.push("/"):this.$router.push(this.$route.query.goto)),this.working=!1}}});var a=(0,n(1900).Z)(s,e,[],!1,null,null,null);a.options.__file="src/pages/login/login.vue";const l=a.exports}}]);